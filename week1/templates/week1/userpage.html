{% extends 'week1/basehome.html'%}

{% block content %}
{% load staticfiles %}


<div id="home-friends">
</div>

<div id="home-main">
    
    <div id="home-firstcolumn">
      
	<div class="home-step">
        <ul style="list-style-type:none">
			<li>City:{{target_profile.city}}</li>
			<li>Work at/as:{{target_profile.worksAt}}</li>
			<li>Education:{{target_profile.education}}</li>
			<li>Language:{{target_profile.language}}</li>
        </ul>
	</div>
	<div class="home-step-out">
            URL:{{ target_profile.weburl }}
        </div>

	<div class="home-step">
            <ul style="list-style-type:none">
                <li>Hobby:{{target_profile.hobby}}</li>
				<li>Favorite quote:{{target_profile.fQuote}}</li>
				<li>Favorite film:{{target_profile.fFilm}}</li>
				<li>Favorite book/author:{{target_profile.fBook}}</li>
				<li>Book/Film/TV show you are reading/watching now:{{target_profile.filmNow}}</li>
            </ul>
	</div>
    </div>

    <div id="home-secondcolumn">
	<div class="home-step">
	{% if target_profile.photo %}
	    <img src="{{ target_profile.photo.url }}" class="maincontent">
	{% else %}
	    <img src="{% static 'images/profileimage.png'%}" class="maincontent">
	{% endif %}
        </div>
	<div class="home-step-out">
            <h3>{{t_user.first_name}}&nbsp{{t_user.last_name}}, {{target_profile.profession}}</h3>
            <p>{{target_profile.describe}}</p>
            <p>
           {% if target_profile.skill1 and target_profile.skill1 != ""%}	
           {{target_profile.skill1}}
           {% endif %}
           {% if target_profile.skill2 and target_profile.skill2 != ""%}	
           &nbsp{{target_profile.skill2}}
           {% endif %}
           {% if target_profile.skill3 and target_profile.skill3 != ""%}	
           &nbsp{{target_profile.skill3}}
           {% endif %}
           {% if target_profile.skill4 and target_profile.skill4 != ""%}	
           &nbsp{{target_profile.skill4}}
           {% endif %}
           {% if target_profile.skill5 and target_profile.skill5 != ""%}	
           &nbsp{{target_profile.skill5}}
           {% endif %}
           {% if target_profile.skill6 and target_profile.skill6 != ""%}	
           &nbsp{{target_profile.skill6}}
           {% endif %}
           {% if target_profile.skill7 and target_profile.skill7 != ""%}	
           &nbsp{{target_profile.skill7}}
           {% endif %}
           {% if target_profile.skill8 and target_profile.skill8 != ""%}	
           &nbsp{{target_profile.skill8}}
           {% endif %}
           {% if target_profile.skill9 and target_profile.skill9 != ""%}	
           &nbsp{{target_profile.skill9}}
           {% endif %}
           {% if target_profile.skill10 and target_profile.skill10 != ""%}	
           &nbsp{{target_profile.skill10}}
           {% endif %}
           </p>
        </div>
    </div>

    <div id="home-thirdcolumn">
       <ul style="list-style-type:none">
	 	 <!--li><img src="{% static 'images/hat.png'%}" class="icons-img"><span id="hatsoffNum"></span></li>
         <li>Thanks &nbsp<span id="thanksNum"></span></li>
         <li>Follow &nbsp<span id="followNum"></span></li-->
	 	 <li><div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"><span id="hatsoffNum"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div></li>
	 	 <li><div class="popupFollow" onclick="popFollow()">Follow&nbsp<span id="followNum"></br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div></li>

	 	 <li><img src="{% static 'images/chat.png'%}" class="icons-img"></li>
	 	 <li><img src="{% static 'images/pitch.png'%}" class="icons-img"></li>
       </ul>

       <!--div class="home-bottom">
	    <ul style="list-style-type:none">
            </br>  <li><div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div></li>
              <li><div class="popupThanks" onclick="popThanks()">Thanks</br><span class="popuptextThanks" id="thanksPop">Give a thanks?</br><button onclick="thanksFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGave"><span class="popuptextGave" id="gavePop">Gave a Thanks!</span></div></li>
              <li><div class="popupFollow" onclick="popFollow()">Follow</br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div></li>
	      <li><a href=""><img src="{% static 'images/contribute.png'%}" class="icons-img"></a></li>
	      <li><img src="{% static 'images/recommend.png'%}" class="icons-img"></li>
	      <li><img src="{% static 'images/help.png'%}" class="icons-img"></li>
	    </ul>
       </div-->
    </div>

<div id="home-main-center">

<div class="portfolio-container">
    <div class="row">
        <h3>Portfolio</h3>
        <div class="col-md-12" data-wow-delay="0.6s">
            <div class="carousel slide" data-ride="carousel" id="quote-carousel" data-interval="false">
                <!-- Carousel Slides / Quotes -->
                <div class="carousel-inner text-center">

                    <!-- Quote 1 -->
		    {% if showcases %}
			{% for showcase in showcases %}
			    {% if forloop.counter == 1 %}
			    <div class="item active">
				<blockquote>
				    <div class="row">
					<div class="col-sm-8 col-sm-offset-2">

					    {% if showcase.image or showcase.youtube %}

						{% if showcase.image %}
						    <img src="{{ showcase.image.url }}" class="maincontent">
						{% endif %}

						{% if showcase.youtube %}
						   <object style="height: 320px; width: 500px"><param name="movie" value="{{showcase.youtube}}"><param name="allowFullScreen" value="true"><param name="allowScriptAccess" value="always"><embed src="{{showcase.youtube}}" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="400" height="300"></object>
						{% endif %}
                        {% else %}
						<img src="{% static 'images/empty_showcase.png'%}" class="maincontent">
                        {% endif %}

					    <ul style="list-style-type:none; padding-left:0px;">
						<li>Title:{{showcase.title}}</li>
						<li>Description of work:{{showcase.describe}}</li>
						<li>Your role:{{showcase.role}}</li>
						<li>Year of completion:{{showcase.completion}}</li>
					    </ul>
                                            <hr class="divider"/>

					    <div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(3, {{forloop.counter}})" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>
					    <div class="popupLike" onclick="popLike()"><button onclick="likeFunction(3, {{forloop.counter}})">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>
					    <div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div>
					    <!--div class="popupThanks" onclick="popThanks()">Thanks</br><span class="popuptextThanks" id="thanksPop">Give a thanks?</br><button onclick="thanksFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGave"><span class="popuptextGave" id="gavePop">Gave a Thanks!</span></div-->
					    <div class="popupFollow" onclick="popFollow()">Follow</br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div>

                                            <ul class="nav nav-tabs">
						<li class="active"><a href="#leaveComment" data-toggle="tab">Leave Comment</a></li>
						<li><a href="#showComment" data-toggle="tab">Show Comment</a></li>
                                            </ul>
                                            <div class="tab-content" style="width:350px; padding:0px; border:0px;">
                                              <div class="tab-pane active" id="leaveComment">
						<div class="well well-ss">
						  <form class="form-horizontal" action="" id="portfolio_form">
						      <fieldset>
						        <!-- Post body -->
						        <div class="form-group">
						          <div class="col-md-9">
						    	<textarea class="form-control" id="c_portfolio_{{forloop.counter}}" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:370px;"></textarea>
						          </div>
						        </div>
    
						        <!-- Form actions -->
						        <div class="form-group">
						          <div class="col-md-12 text-right">
						    	      <button class="btn btn-primary btn-lg" onclick="submitPForm({{forloop.counter}})">Post</button>
						          </div>
						        </div>
						      </fieldset>
						  </form>
						</div>
					      </div>

                                              <div class="tab-pane" id="showComment">
					        <ul style="list-style-type:none; padding-left:0px;">
			                            <div id="portfolioComment_{{forloop.counter}}"></div>
                                                </ul>
                                              </div>
                                           </div>


					</div>
				    </div>
				</blockquote>
			    </div>
                            {% else %}
			    <div class="item">
			    <blockquote>
			    <div class="row">
					<div class="col-sm-8 col-sm-offset-2">

                        {% if showcase.image or showcase.video or showcase.youtube %}

						{% if showcase.image %}
						    <img src="{{ showcase.image.url }}" class="maincontent">
						{% endif %}

						{% if showcase.video %}
						    <video controls id="video">
						        <source src="{{ showcase.video.url }}" class="maincontent" type="video/mp4"></source>
						    </video>
						{% endif %}

						{% if showcase.youtube %}
						   <object style="height: 320px; width: 500px"><param name="movie" value="{{showcase.youtube}}"><param name="allowFullScreen" value="true"><param name="allowScriptAccess" value="always"><embed src="{{showcase.youtube}}" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="400" height="300"></object>
						{% endif %}
                        {% else %}
						<img src="{% static 'images/empty_showcase.png'%}" class="maincontent">
                        {% endif %}


					    <ul style="list-style-type:none; padding-left:0px;">
						<li>Title:{{showcase.title}}</li>
						<li>Description of work:{{showcase.describe}}</li>
						<li>Your role:{{showcase.role}}</li>
						<li>Year of completion:{{showcase.completion}}</li>
					    </ul>
					    <div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(3, {{forloop.counter}})" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>
					    <div class="popupLike" onclick="popLike()"><button onclick="likeFunction(3, {{forloop.counter}})">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>
					    <div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div>
					    <!--div class="popupThanks" onclick="popThanks()">Thanks</br><span class="popuptextThanks" id="thanksPop">Give a thanks?</br><button onclick="thanksFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGave"><span class="popuptextGave" id="gavePop">Gave a Thanks!</span></div-->
					    <div class="popupFollow" onclick="popFollow()">Follow</br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div>

                                            <hr class="divider"/>
                                            
                                            <ul class="nav nav-tabs">
						<li class="active"><a href="#leaveComment_{{forloop.counter}}" data-toggle="tab">Leave Comment</a></li>
						<li><a href="#showComment_{{forloop.counter}}" data-toggle="tab">Show Comment</a></li>
                                            </ul>

                                            <div class="tab-content" style="width:350px; padding:0px; border:0px;">
                                              <div class="tab-pane active" id="leaveComment_{{forloop.counter}}">
						<div class="well well-ss">
						  <form class="form-horizontal" action="" id="portfolio_form">
						      <fieldset>
						        <!-- Post body -->
						        <div class="form-group">
						          <div class="col-md-9">
						    	<textarea class="form-control" id="c_portfolio_{{forloop.counter}}" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:370px;"></textarea>
						          </div>
						        </div>
    
						        <!-- Form actions -->
						        <div class="form-group">
						          <div class="col-md-12 text-right">
						    	     <button class="btn btn-primary btn-lg" onclick="submitPForm({{forloop.counter}})">Post</button>
						          </div>
						        </div>
						      </fieldset>
						  </form>
						</div>
					      </div>

                                              <div class="tab-pane" id="showComment_{{forloop.counter}}">
					        <ul style="list-style-type:none; padding-left:0px;">
			                            <div id="portfolioComment_{{forloop.counter}}"></div>
                                                </ul>
                                              </div>
                                           </div>


					</div>
				    </div>
				</blockquote>
			    </div>
                            {% endif %}
                        {% endfor %}
                    {% else %}
	            <a href="{% url 'week1:edit_newpreviouswork' %}"><img src="{% static 'images/edit.png'%}" align="right"></a>
	            <img src="{% static 'images/empty_showcase.png'%}" class="maincontent">
                    {% endif %}
                </div>

                <!-- Carousel Buttons Next/Prev -->
                <a data-slide="prev" href="#quote-carousel" class="left carousel-control"><i class="fa fa-chevron-left"></i></a>
                <a data-slide="next" href="#quote-carousel" class="right carousel-control"><i class="fa fa-chevron-right"></i></a>
            </div>
        </div>
   </div>
</div>


	<div class="home-step">
            <script>
		function show_upcoming(){
                    console.log('show more!');
		    $('#upcomingComment').show();
		    $('#upcoming_hide').show();
		    $('#upcoming_show').hide();
		};

		function hide_upcoming(){
                    console.log('hide more!');
		    $('#upcomingComment').hide();
		    $('#upcoming_hide').hide();
		    $('#upcoming_show').show();
		};
            </script>

            <h3>What’s Next</h3>
	    {% if upcoming %}
	        {% if upcoming.image %}
	            <img src="{{ upcoming.image.url }}" class="maincontent">
	        {% else %}
	            <img src="{% static 'images/empty_showcase.png'%}" class="maincontent"></li>
	        {% endif %}
	    {% else %}
	        <img src="{% static 'images/empty_showcase.png'%}" class="maincontent">
	    {% endif %}

	    {% if upcoming %}
            <div class="description-wrapper">
              <ul style="list-style-type:none">
	        <li>Description of your upcoming work:{{upcoming.describe}}</li>
	        <li>Your role:{{upcoming.role}}</li>
	        <li>Status:{{upcoming.status}}</li>
	        <li>Target finish date:{{upcoming.targetdate}}</li>
	        <li>Comment:{{upcoming.comment}}</li>
	      </ul>
              <ul>
	        <li><h4>Looking for</h4>
                    <br>{{upcoming.collaborators}}</br></li>
	        <li>Funding:{{upcoming.fund}}</li>
	        <li>Comment:{{upcoming.comment_help}}</li>
	      </ul>
            </div>
            <div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(2, 1)" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>
            <div class="popupLike" onclick="popLike()"><button onclick="likeFunction(2, 1)">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>
	    <div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div>
	    <!--div class="popupThanks" onclick="popThanks()">Thanks</br><span class="popuptextThanks" id="thanksPop">Give a thanks?</br><button onclick="thanksFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGave"><span class="popuptextGave" id="gavePop">Gave a Thanks!</span></div-->
	    <div class="popupFollow" onclick="popFollow()">Follow</br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div>

            <hr class="divider"/>
             
            <ul class="nav nav-tabs">
	        <li class="active"><a href="#leaveComment_upcoming" data-toggle="tab">Leave Comment</a></li>
	        <li><a href="#showComment_upcoming" data-toggle="tab">Show Comment</a></li>
            </ul>

            <div class="tab-content" style="width:350px; padding:0px; border:0px;">
              <div class="tab-pane active" id="leaveComment_upcoming">
	        <div class="well well-ssm">
	          <form class="form-horizontal" action="" id="upcoming_form">
	              <fieldset>
	                <!-- Post body -->
	                <div class="form-group">
	                  <div class="col-md-9">
	                    <textarea class="form-control" id="c_upcoming" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:470px;"></textarea>
	                  </div>
	                </div>
    
	                <!-- Form actions -->
	                <div class="form-group">
	                  <div class="col-md-12 text-right">
	             	    <button class="btn btn-primary btn-lg" onclick="submitUForm()">Post</button>
	                  </div>
	                </div>
	              </fieldset>
	          </form>
	        </div>
	      </div>

              <div class="tab-pane" id="showComment_upcoming">
	        <ul style="list-style-type:none; padding-left:30px;">
	          <div id="upcomingComment"></div>
                </ul>
              </div>
           </div>

	    <!--div class="post-wrapper">
		<form action="" id="upcoming_form">
		  <textarea id="c_upcoming" autocomplete="off" placeholder=" Comment" rows="3" cols="60"></textarea>
                  <button onclick="submitUForm()">Post</button>
		</form>
	    </div>
	    <ul style="list-style-type:none; padding-left:0px;">
                <div id="upcoming_show">
                   <button onclick="show_upcoming()">Show Comments</button>
                </div>
                <div id="upcoming_hide">
                   <button onclick="hide_upcoming()">Hide Comments</button>
                </div>
		<div id="upcomingComment"></div>
	    </ul-->
	    {% endif %}
	</div>

	<script src="{{nodejs_url}}/socket.io/socket.io.js"></script>
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script>
	      var socket = io.connect("{{nodejs_url}}");
	      socket.emit('join message', {uid:{{user.id}}, firstname:"{{user.first_name}}", lastname:"{{user.last_name}}"});
	      socket.emit('at userpage', {uid:{{user.id}}, to_uid:{{t_user.id}}, uname:"{{user.first_name}}"});

	      socket.on('number user thanks', function(count){
                  document.getElementById("thanksNum").innerHTML = count;
              });

	      socket.on('number user hatsoff', function(count){
                  document.getElementById("hatsoffNum").innerHTML = count;
              });

	      socket.on('number user follow', function(count){
                  document.getElementById("followNum").innerHTML = count;
              });


	      function likeFunction(c_type, c_id){
		    console.log('uid on like:'+c_type+':'+c_id);
		    popLike();
            if (c_type == 2){
			    socket.emit('like upcoming', {to_uid:{{t_user.id}}, uid:{{user.id}}, c_id:c_id});
			    console.log('like upcoming');
            }else if (c_type == 3){
			    socket.emit('like portfolio', {to_uid:{{t_user.id}}, uid:{{user.id}}, c_id:c_id});
			    console.log('like portfolio');
            }
		 //socket.emit('like community', {to_uid:uid, uid:{{user.id}}, c_id:c_id});
	      }

	      function popLike(){
			 var popup = document.getElementById('likePop');
			 popup.classList.toggle('show');
	      }

	      function popShare(){
			 var popup = document.getElementById('sharePop');
			 popup.classList.toggle('show');
	      }

	      function shareFunction(c_type, c_id){
			 console.log('uid on share:'+c_type+':'+c_id);
			 popShared();
             if (c_type == 2){
		         socket.emit('share upcoming', {to_uid:{{t_user.id}}, uid:{{user.id}}, c_id:c_id});
             }else if (c_type == 3){
		         socket.emit('share portfolio', {to_uid:{{t_user.id}}, uid:{{user.id}}, c_id:c_id});
             }
		 //socket.emit('share upcoming', {to_uid:uid, uid:{{user.id}}, c_id:c_id});
	      }

	      function popShared(){
			 var popup = document.getElementById('sharedPop');
			 popup.classList.toggle('show');
	      }

	      function popThanks(){
			 var popup = document.getElementById('thanksPop');
			 popup.classList.toggle('show');
	      }

	      function thanksFunction(){
			 console.log('thanks!');
			 popGave();
			 socket.emit('give thanks', {to_uid:{{t_user.id}}, uid:{{user.id}}});
			 console.log('thanks!');
	      }

	      function popGave(){
			 var popup = document.getElementById('gavePop');
			 popup.classList.toggle('show');
	      }

	      function popHatsoff(){
			 var popup = document.getElementById('hatsoffPop');
			 popup.classList.toggle('show');
	      }

	      function hatsoffFunction(){
			 console.log('hatsoff!');
			 popGavehatsoff();
			 socket.emit('give hatsoff', {to_uid:{{t_user.id}}, uid:{{user.id}}});
	      }

	      function popGavehatsoff(){
			 var popup = document.getElementById('gavehatsoffPop');
			 popup.classList.toggle('show');
	      }

	      function popFollow(){
			 var popup = document.getElementById('followPop');
			 popup.classList.toggle('show');
	      }

	      function followFunction(){
			 console.log('follow!');
			 popFollowed();
		     socket.emit('give follow', {to_uid:{{t_user.id}}, uid:{{user.id}}});
	      }

	      function popFollowed(){
			 var popup = document.getElementById('followedPop');
			 popup.classList.toggle('show');
	      }

          var p_id = 1
    	  function changeContent(number, length){
                console.log('Click!'+number);
	            //socket.emit('change portfolio', {uid:{{user.id}}, to_uid:{{t_user.id}}, p_id:number});
                if( p_id != number ){
	               socket.emit('at userpage', {uid:{{user.id}}, to_uid:{{t_user.id}}, uname:"{{user.first_name}}"});
                }

                for (var i = 1; i <= length; i++){
		           $('#'+i).show().siblings('div').hide();
		        }
			    $('#'+number).show().siblings('div').hide();
	               p_id = number;

	               var h = document.getElementById('portfolio_hide');
	               var s = document.getElementById('portfolio_show');
			    if (h.style.display == 'block'){
			        h.style.display = 'none';
			    }
			    s.style.display = 'block';
	            hide_portfolio(number);
	      };

	      function show_portfolio(number, length){
                console.log('show more!');
                for (var i = 1; i <= length; i++){
		            $('#portfolioComment_'+i).hide();
		        }
			    $('#portfolioComment_'+number).show();
	            var h = document.getElementById('portfolio_hide');
	            var s = document.getElementById('portfolio_show');
			    if (s.style.display == 'block'){
			        s.style.display = 'none';
			    }
			    h.style.display = 'block';
                    /***
		    if ($('#portfolio_hide').style.display == 'block'){
		        $('#portfolio_hide').style.display = 'none';
		    }
		    $('#portfolio_show').style.display = 'block';
                    **/
                    /***
		    $('#portfolio_hide').show();
		    $('#portfolio_show').hide();
                    ***/
	      };

	      function hide_portfolio(number){
            console.log('hide more!');
		    $('#portfolioComment_'+number).hide();
            var h = document.getElementById('portfolio_hide');
            var s = document.getElementById('portfolio_show');
		    if (h.style.display == 'block'){
		        h.style.display = 'none';
		    }
		    s.style.display = 'block';
                    /*** 
		    $('#portfolioComment_'+number).hide();
		    if ($('#portfolio_show').style.display == 'block'){
		        $('#portfolio_show').style.display = 'none';
                    }
		    $('#portfolio_block').style.display = 'block';
                    ***/
	      };

              // For portfolio
              function submitPForm(number){
                    console.log('form submit portfolio');
                    var post_val = $('#c_portfolio_'+number).val();
                    
                    if (post_val.length != 0){
                        console.log('if:'+p_id+':'+post_val);
		        socket.emit('portfolio comment', {msg:post_val, to:{{t_user.id}}, uid:{{user.id}}, p_id:number});
                    }
		    $('#c_portfolio_'+number).val('');
		    return false;
              }

	      socket.on('new portfolio comment', function(data){
            console.log('new portfolio comment on home');
		    var uid = data.from_uid;
            var p_id = data.p_id;
            console.log(p_id);
		    var users = [{% for u in users %} {{ u }} ,{% endfor %}];
		    var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
		    var n  = users.indexOf(uid);
		    var url_mask = "{% url 'week1:add_folder' user.id %}".replace({{user.id}}, uid);
		    var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
		    if ( n != -1) {
		          if (uid == {{user.id}}){
		             $('#portfolioComment_'+p_id).prepend($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+'</br><p>'+data.msg+'</p><br/><hr class="divider"/>'));
		          } else{
		             $('#portfolioComment_'+p_id).prepend($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+data.msg+'</p><br/><hr class="divider"/>'));
		          }

		    }else{
		          if (uid == {{user.id}}){
		             $('#portfolioComment_'+p_id).prepend($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+'</br><p>'+data.msg+'</p><br/><hr class="divider"/>'));
		          } else {
		             $('#portfolioComment_'+p_id).prepend($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+data.msg+'</p><br/><hr class="divider"/>'));
		          }
		    }
	      });

	      socket.on('update portfolio comment', function(docs){
            console.log('socket on portfolio comment:'+p_id);
		    var users = [{% for u in users %} {{ u }} ,{% endfor %}];
		    var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
	        for(var i = 0; i < docs.length; i++){
                if (docs[i]['p_id']) {
                    var p_id = docs[i]['p_id'];
                    console.log('If!');
		            if (docs[i]['user']['uid']){
						var uid = docs[i]['user']['uid'];
						var n  = users.indexOf(uid);
						var data = docs[i];
						var url_mask = "{% url 'week1:add_folder' user.id %}".replace({{user.id}}, uid);
						var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
				if ( n != -1) {
				      if (uid == {{user.id}}){
				         $('#portfolioComment_'+p_id).append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+data['user']['first_name']+'&nbsp'+data['user']['last_name']+'</br><p>'+data['content']+'</p><br/><hr class="divider"/>'));
				      } else{
				         $('#portfolioComment_'+p_id).append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+data['user']['first_name']+'&nbsp'+data['user']['last_name']+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+data['content']+'</p><br/><hr class="divider"/>'));
				      }

				}else{
				      if (uid == {{user.id}}){
				         $('#portfolioComment_'+p_id).append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+data['user']['first_name']+'&nbsp'+data['user']['last_name']+'</br><p>'+data['content']+'</p><br/><hr class="divider"/>'));
				      } else {
				         $('#portfolioComment_'+p_id).append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+data['user']['first_name']+'&nbsp'+data['user']['last_name']+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+data['content']+'</p><br/><hr class="divider"/>'));
				      }
				}
                          }

                      } else{
                          console.log('Else!');
                      }
	          }
	      });


	      //$('#upcoming_form').submit(function(){
              function submitUForm(){
                    console.log('form submit');
                    var com = $('#c_upcoming').val();
                    if (com.length != 0){
		        socket.emit('upcoming comment', {msg:com, to:{{t_user.id}}, uid:{{user.id}}});
                    }
		    $('#c_upcoming').val('');
		    return false;
	      }

	      socket.on('update upcoming comment', function(docs){
		    var users = [{% for u in users %} {{ u }} ,{% endfor %}];
		    var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
		    for(var i=0; i < docs.length; i++){
		       if (docs[i]['user']['uid']){
			    var uid = docs[i]['user']['uid'];
			    var n  = users.indexOf(uid);
			    var url_mask = "{% url 'week1:add_folder' user.id %}".replace({{user.id}}, uid);
			    var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
			    if ( n != -1) {
			       if (uid == {{user.id}}){
			     $('#upcomingComment').append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+docs[i]['user']['first_name']+'&nbsp'+docs[i]['user']['last_name']+'</br><p>'+docs[i]['content']+'</p><br/><hr class="divider"/>'));
			       } else{
			     $('#upcomingComment').append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+docs[i]['user']['first_name']+'&nbsp'+docs[i]['user']['last_name']+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+docs[i]['content']+'</p><br/><hr class="divider"/>'));
			       }
			    } else{
			       if (uid == {{user.id}}){
			     $('#upcomingComment').append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+docs[i]['user']['first_name']+'&nbsp'+docs[i]['user']['last_name']+'</br><p">'+docs[i]['content']+'</p><br/><hr class="divider"/>'));
			       } else{
			     $('#upcomingComment').append($('<li><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png' %}" class="profile_img"></a>'+docs[i]['user']['first_name']+'&nbsp'+docs[i]['user']['last_name']+'&nbsp <a href="'+url_mask+'">folder</a></br><p>'+docs[i]['content']+'</p><br/><hr class="divider"/>'));
			       }
			    }
		       }
		    }
	      });
 
          /***
          ***/

          function submitCForm(){
                console.log('post comment');
                if ($('#comment').val().length != 0){
                    socket.emit('post comment', {msg:$('#comment').val(), to:{{uid}}, from:{{user.id}}});
                }
                $('#comment').val('');            
                return false;
          }


	  socket.on('update comment', function(docs){
	    var users = [{% for u in users %} {{ u }} ,{% endfor %}];
            var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
	    for(var i = 0; i < docs.length; i++){
		if (docs[i]['from_user']['uid']){
			var uid = docs[i]['from_user']['uid'];
			var n  = users.indexOf(uid);
			var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
			if ( n != -1) {
			    $('#commentHistory').append($('<li><span class="error"><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+docs[i]['from_user']['first_name']+'&nbsp'+docs[i]['from_user']['last_name']+':'+docs[i]['content']+'</span><br/>'));
			}else{
			    $('#commentHistory').append($('<li><span class="error"><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img"></a>'+docs[i]['from_user']['first_name']+'&nbsp'+docs[i]['from_user']['last_name']+':'+docs[i]['content']+'</span><br/>'));

			}
                }
	      }
	  });

	  socket.on('new comment', function(data){
                console.log('new comment on userpage');
	        var uid = data.from;
                console.log(p_id);
	        var users = [{% for u in users %} {{ u }} ,{% endfor %}];
	        var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
	        var n  = users.indexOf(uid);
		var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
	        if ( n != -1) {
	            $('#commentHistory').prepend($('<li><span class="error"><br><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[n]+'" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+':'+data.msg+'</span><br/>'));
	        }else{
	            $('#commentHistory').prepend($('<li><span class="error"><br><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img"></a>'+data.from_firstname+'&nbsp'+data.from_lastname+':'+data.msg+'</span><br/>'));
	        }
	  });


	  socket.on('update user timeline history', function(data){
                console.log('update user timeline history');
                var sharedocs = data.share;
                var communitydocs = data.community;
                var len_share = sharedocs.length;
                var len_community = communitydocs.length;
	            var users = [{% for u in users %} {{ u }} ,{% endfor %}];
	            var photos = [{% for p in userphoto %}"{{ p }}", {% endfor %}];
                var i_share = 0;
                var i_community = 0;
		        var hatsoff = '<div class="popupHatsoff" onclick="popHatsoff()"><img src="{% static 'images/hat.png'%}" class="icons-img"></br><span class="popuptextHatsoff" id="hatsoffPop">Give a Hatsoff?</br><button onclick="hatsoffFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGavehatsoff"><span class="popuptextGavehatsoff" id="gavehatsoffPop">Gave a Hatsoff!</span></div>';
		        //var thanks = '<div class="popupThanks" onclick="popThanks()">Thanks</br><span class="popuptextThanks" id="thanksPop">Give a thanks?</br><button onclick="thanksFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">No</button></span></div><div class="popupGave"><span class="popuptextGave" id="gavePop">Gave a Thanks!</span></div>';
		        var thanks = '';
		        var follow = '<div class="popupFollow" onclick="popFollow()">Follow</br><span class="popuptextFollow" id="followPop">Follow this user?</br><button onclick="followFunction()" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupFollowed"><span class="popuptextFollowed" id="followedPop">Followed the user!</span></div>';


		        while (i_share < len_share || i_community < len_community){
                    if (i_share < len_share && i_community < len_community){
                       var t_share = sharedocs[i_share]["created"];
                       var t_community = communitydocs[i_community]["created"];
                       if (t_share > t_community){
                       	  var share = '<div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(4, 1)" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>';
						  var like = '<div class="popupLike" onclick="popLike()"><button onclick="likeFunction(4, 1)">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>';
						  var uid = sharedocs[i_share]['to_uid'];
			              var content = sharedocs[i_share]['content'];
			              var c_id = sharedocs[i_share]['_id'];
						  var n  = users.indexOf(uid);
                          var collaborate = '<div class="popupCollaborate" onclick="collaborateFunction(\''+uid+'\',\''+c_id+'\')"><button class="collaborate-btn">Collaborate &nbsp</button><span class="popuptextCollaborate" id="collaboratePop">Collaborated</br></span></div><hr class="divider"/>';
                          var comment = '<div class="well well-ssm"><ul id="commentHistory_'+c_id+'" style="list-style-type:none;"></ul><form class="form-horizontal" action=""><div class="form-group"><div class="col-md-9"><textarea class="form-control" id="c_'+c_id+'" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:490px;"></textarea></div></div><div class="form-group"><div class="col-md-12 text-right"><button class="btn btn-primary btn-lg" onclick="submitComment(\''+uid+'\',\''+c_id+'\')">Post</button></div></div></form></div>';

                          var tag = (content['tag']) ? content['tag'] : 0;
						  var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
                          var post_link = "{% url 'week1:community_post'%}?c_id="+c_id+"&tag="+tag+"&u="+uid;
                          var skillls = "";
						  if (content['skillls']){
	                          if(content['skillls'].length != 0){
	                            var ls = content['skillls'];
	                            skillls += "<div> Tags: ";
	                            for (var j = 0; j < ls.length; j++){
	                              var skill_link = "{% url 'week1:talent_list' 12345 %}".replace(/12345/, ls[j]);
	                              skillls += "<a href='"+skill_link+"'>"+ls[j]+"</a>" + "&nbsp";
	                            } 
	                            skillls += "</div><br>";
	                          }
                          }
			                          
						  $('.timeline').append($('<li><div class="timeline-badge info"><i class="glyphicon glyphicon-credit-card"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title">'+'{{t_user.first_name}}'+'&nbsp'+'{{t_user.last_name}}'+' shared</h4><p><small class="text-muted"><i class="glyphicon glyphicon-time"></i></small></p><div class="media-body"><div class="well well-lg"><a href="'+url_link+'"><img class="profile_img" src="{{media_url}}'+photos[n]+'" alt="profile"></a><span class="media-heading text-uppercase reviews" >'+'&nbsp'+content['user']['first_name']+'&nbsp'+content['user']['last_name']+'</span></a><ul class="media-date text-uppercase reviews list-inline"><li class="dd">22</li><li class="mm">09</li><li class="aaaa">2014</li></ul><a href="'+post_link+'"><p class="media-comment" style="display: block;">'+content['content']+'</p></a>'+skillls+like+share+hatsoff+thanks+collaborate+comment+'</div></div></li></div></li>'));
						  	//<div class="timeline-body"><br>'+content['user']['first_name']+content['user']['last_name']+'</br><hr class="divider"/>'+content['content']+'</div></div>'+share+like+hatsoff+thanks+follow+'</div></li>'));
						  if (content['replys']) {
	                           var rdocs = content['replys'];
	                           console.log('replys');
	                           for(var j=0; j < rdocs.length; j++){
	                              if (rdocs[j]['user']['uid']){
	                      			var ruid = rdocs[j]['user']['uid']
	                      			var m  = users.indexOf(ruid);
	                      			var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, ruid);
	                      			if ( m != -1) {
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[m]+'" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}else{
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}
	                             }
	                           }
                          }

                          i_share += 1;
                       }else{
                       	  var uid = {{t_user.id}};
			              var content = communitydocs[i_community];
                       	  var share = '<div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(1, 1)" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>';
						  var like = '<div class="popupLike" onclick="popLike()"><button onclick="likeFunction(1, 1)">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>';

						  var c_id = content['_id'];
						  var n  = users.indexOf(uid);
                          var collaborate = '<div class="popupCollaborate" onclick="collaborateFunction(\''+uid+'\',\''+c_id+'\')"><button class="collaborate-btn">Collaborate &nbsp</button><span class="popuptextCollaborate" id="collaboratePop">Collaborated</br></span></div><hr class="divider"/>';
                          var comment = '<div class="well well-ssm"><ul id="commentHistory_'+c_id+'" style="list-style-type:none;"></ul><form class="form-horizontal" action=""><div class="form-group"><div class="col-md-9"><textarea class="form-control" id="c_'+c_id+'" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:490px;"></textarea></div></div><div class="form-group"><div class="col-md-12 text-right"><button class="btn btn-primary btn-lg" onclick="submitComment(\''+uid+'\',\''+c_id+'\')">Post</button></div></div></form></div>';

                          var tag = (content['tag']) ? content['tag'] : 0;
						  var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
                          var post_link = "{% url 'week1:community_post'%}?c_id="+c_id+"&tag="+tag+"&u="+uid;
                          var skillls = "";
						  if (content['skillls']){
	                          if(content['skillls'].length != 0){
	                            var ls = content['skillls'];
	                            skillls += "<div> Tags: ";
	                            for (var j = 0; j < ls.length; j++){
	                              var skill_link = "{% url 'week1:talent_list' 12345 %}".replace(/12345/, ls[j]);
	                              skillls += "<a href='"+skill_link+"'>"+ls[j]+"</a>" + "&nbsp";
	                            } 
	                            skillls += "</div><br>";
	                          }
                          }


						  $('.timeline').append($('<li><div class="timeline-badge"><i class="glyphicon glyphicon-check"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title">'+'{{t_user.first_name}}'+'&nbsp'+'{{t_user.last_name}}'+' posted to community </h4><p><small class="text-muted"><i class="glyphicon glyphicon-time"></i></small></p><div class="media-body"><div class="well well-lg"><a href="'+url_link+'"><img class="profile_img" src="{{media_url}}'+photos[n]+'" alt="profile"></a><span class="media-heading text-uppercase reviews" >'+'&nbsp'+content['user']['first_name']+'&nbsp'+content['user']['last_name']+'</span></a><ul class="media-date text-uppercase reviews list-inline"><li class="dd">22</li><li class="mm">09</li><li class="aaaa">2014</li></ul><a href="'+post_link+'"><p class="media-comment" style="display: block;">'+content['content']+'</p></a>'+skillls+like+share+hatsoff+thanks+collaborate+comment+'</div></div></li></div></li>'));
						  //$('.timeline').append($('<li><div class="timeline-badge"><i class="glyphicon glyphicon-check"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title">You posted to community</h4><p><small class="text-muted"><i class="glyphicon glyphicon-time"></i></small></p><div class="timeline-body">'+communitydocs[i_community]['content']+'</div></div>'+share+like+hatsoff+thanks+follow+'</div></li>'));

						  if (content['replys']) {
	                           var rdocs = content['replys'];
	                           console.log('replys');
	                           for(var j=0; j < rdocs.length; j++){
	                              if (rdocs[j]['user']['uid']){
	                      			var ruid = rdocs[j]['user']['uid']
	                      			var m  = users.indexOf(ruid);
	                      			var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, ruid);
	                      			if ( m != -1) {
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[m]+'" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}else{
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}
	                             }
	                           }
                          }

                          i_community += 1;
                       }

                    }else if(i_share < len_share){

						var share = '<div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(4, 1)" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>';
						var like = '<div class="popupLike" onclick="popLike()"><button onclick="likeFunction(4, 1)">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>';
						var uid = sharedocs[i_share]['to_uid'];
			            var content = sharedocs[i_share]['content'];
			            var c_id = sharedocs[i_share]['_id'];
						var n  = users.indexOf(uid);
                        var collaborate = '<div class="popupCollaborate" onclick="collaborateFunction(\''+uid+'\',\''+c_id+'\')"><button class="collaborate-btn">Collaborate &nbsp</button><span class="popuptextCollaborate" id="collaboratePop">Collaborated</br></span></div><hr class="divider"/>';
                        var comment = '<div class="well well-ssm"><ul id="commentHistory_'+c_id+'" style="list-style-type:none;"></ul><form class="form-horizontal" action=""><div class="form-group"><div class="col-md-9"><textarea class="form-control" id="c_'+c_id+'" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:490px;"></textarea></div></div><div class="form-group"><div class="col-md-12 text-right"><button class="btn btn-primary btn-lg" onclick="submitComment(\''+uid+'\',\''+c_id+'\')">Post</button></div></div></form></div>';

                        var tag = (content['tag']) ? content['tag'] : 0;
						var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
                        var post_link = "{% url 'week1:community_post'%}?c_id="+c_id+"&tag="+tag+"&u="+uid;
                        var skillls = "";
						if (content['skillls']){
	                        if(content['skillls'].length != 0){
	                          var ls = content['skillls'];
	                          skillls += "<div> Tags: ";
	                          for (var j = 0; j < ls.length; j++){
	                            var skill_link = "{% url 'week1:talent_list' 12345 %}".replace(/12345/, ls[j]);
	                            skillls += "<a href='"+skill_link+"'>"+ls[j]+"</a>" + "&nbsp";
	                          } 
	                          skillls += "</div><br>";
	                        }
                        }
			                          
					    $('.timeline').append($('<li><div class="timeline-badge info"><i class="glyphicon glyphicon-credit-card"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title">'+'{{t_user.first_name}}'+'&nbsp'+'{{t_user.last_name}}'+' shared</h4><p><small class="text-muted"><i class="glyphicon glyphicon-time"></i></small></p><div class="media-body"><div class="well well-lg"><a href="'+url_link+'"><img class="profile_img" src="{{media_url}}'+photos[n]+'" alt="profile"></a><span class="media-heading text-uppercase reviews" >'+'&nbsp'+content['user']['first_name']+'&nbsp'+content['user']['last_name']+'</span></a><ul class="media-date text-uppercase reviews list-inline"><li class="dd">22</li><li class="mm">09</li><li class="aaaa">2014</li></ul><a href="'+post_link+'"><p class="media-comment" style="display: block;">'+content['content']+'</p></a>'+skillls+like+share+hatsoff+thanks+collaborate+comment+'</div></div></li></div></li>'));

					    if (content['replys']) {
	                           var rdocs = content['replys'];
	                           console.log('replys');
	                           for(var j=0; j < rdocs.length; j++){
	                              if (rdocs[j]['user']['uid']){
	                      			var ruid = rdocs[j]['user']['uid']
	                      			var m  = users.indexOf(ruid);
	                      			var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, ruid);
	                      			if ( m != -1) {
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[m]+'" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}else{
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}
	                             }
	                           }
                        }

                        i_share += 1;

                    }else if(i_community < len_community){

						var uid = {{t_user.id}};
			            var content = communitydocs[i_community];
                       	var share = '<div class="popupShare" onclick="popShare()">Share &nbsp</br><span class="popuptextShare" id="sharePop">Share this project?</br><button onclick="shareFunction(1, 1)" class="shareskillButton">Yes</button>&nbsp<button class="shareskillButton">Not Now</button></span></div><div class="popupShared"><span class="popuptextShared" id="sharedPop">Shared!</span></div>';
						var like = '<div class="popupLike" onclick="popLike()"><button onclick="likeFunction(1, 1)">Like</button></br><span class="popuptextLike" id="likePop">You Liked it</br></span></div>';

						var c_id = content['_id'];
						var n  = users.indexOf(uid);
                        var collaborate = '<div class="popupCollaborate" onclick="collaborateFunction(\''+uid+'\',\''+c_id+'\')"><button class="collaborate-btn">Collaborate &nbsp</button><span class="popuptextCollaborate" id="collaboratePop">Collaborated</br></span></div><hr class="divider"/>';
                        var comment = '<div class="well well-ssm"><ul id="commentHistory_'+c_id+'" style="list-style-type:none;"></ul><form class="form-horizontal" action=""><div class="form-group"><div class="col-md-9"><textarea class="form-control" id="c_'+c_id+'" autocomplete="off" name="message" placeholder="Please enter your comment here..." rows="3" style="width:490px;"></textarea></div></div><div class="form-group"><div class="col-md-12 text-right"><button class="btn btn-primary btn-lg" onclick="submitComment(\''+uid+'\',\''+c_id+'\')">Post</button></div></div></form></div>';

                        var tag = (content['tag']) ? content['tag'] : 0;
						var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, uid);
                        var post_link = "{% url 'week1:community_post'%}?c_id="+c_id+"&tag="+tag+"&u="+uid;
                        var skillls = "";
						if (content['skillls']){
	                        if(content['skillls'].length != 0){
	                          var ls = content['skillls'];
	                          skillls += "<div> Tags: ";
	                          for (var j = 0; j < ls.length; j++){
	                            var skill_link = "{% url 'week1:talent_list' 12345 %}".replace(/12345/, ls[j]);
	                            skillls += "<a href='"+skill_link+"'>"+ls[j]+"</a>" + "&nbsp";
	                          } 
	                          skillls += "</div><br>";
	                        }
                        }

						$('.timeline').append($('<li><div class="timeline-badge"><i class="glyphicon glyphicon-check"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title">'+'{{t_user.first_name}}'+'&nbsp'+'{{t_user.last_name}}'+' posted to community </h4><p><small class="text-muted"><i class="glyphicon glyphicon-time"></i></small></p><div class="media-body"><div class="well well-lg"><a href="'+url_link+'"><img class="profile_img" src="{{media_url}}'+photos[n]+'" alt="profile"></a><span class="media-heading text-uppercase reviews" >'+'&nbsp'+content['user']['first_name']+'&nbsp'+content['user']['last_name']+'</span></a><ul class="media-date text-uppercase reviews list-inline"><li class="dd">22</li><li class="mm">09</li><li class="aaaa">2014</li></ul><a href="'+post_link+'"><p class="media-comment" style="display: block;">'+content['content']+'</p></a>'+skillls+like+share+hatsoff+thanks+collaborate+comment+'</div></div></li></div></li>'));

						if (content['replys']) {
	                           var rdocs = content['replys'];
	                           console.log('replys');
	                           for(var j=0; j < rdocs.length; j++){
	                              if (rdocs[j]['user']['uid']){
	                      			var ruid = rdocs[j]['user']['uid']
	                      			var m  = users.indexOf(ruid);
	                      			var url_link = "{% url 'week1:get_profile' user.id %}".replace({{user.id}}, ruid);
	                      			if ( m != -1) {
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{{media_url}}'+photos[m]+'" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}else{
	                      			   $('#commentHistory_'+c_id).append($('<hr class="solid-divider"/><li><a href="'+url_link+'" class="link-userpage"><img src="{% static 'images/profileimage.png'%}" class="profile_img">'+rdocs[j]['user']['first_name']+'&nbsp'+rdocs[j]['user']['last_name']+'</a>&nbsp</br><p>'+rdocs[j]['content']+'</p>'));
	                      			}
	                             }
	                           }
                        }

                        i_community += 1;

                    }

                }

	  });

	</script>


	<!--div id="thanks-hatsoff">
	    <h4>Thanks - Hats off</h4>
	    <div id="hatsoffusers">
		{% if hatsusers %}
		     {% for h in hatsusers %}
			{% if h.photo %}
			   <img src="{{ h.photo.url }}" width="50px">
			{% else %}
			   <img src="{% static 'images/profileimage.png'%}" width="50px">
			{% endif %}
		     {% endfor %}
		{% endif %}
	    </div>
	</div-->

<!--div id="home-comment">
    <div id="commentpost-wrapper">
    <h4> Comments </h4>
	 <form action="" id="postComment">
	    <textarea id="comment" autocomplete="off" placeholder=" Comment for {{t_user.first_name}}" rows="3" cols="60"></textarea>
            <button onclick="submitCForm()">Post</button>
	 </form>
    </div>

    <div id="comments-wrapper">
	 <ul style="list-style-type:none; padding-left: 0;">
	     <div id="commentHistory"></div>
	 </ul>
    </div>
    </div>
</div-->

<div class="timeline-container">
    <ul class="timeline">
    </ul>
</div>


</div>

{% endblock %}
